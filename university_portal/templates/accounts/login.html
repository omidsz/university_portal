<!--<!DOCTYPE html>-->
<!--<html lang="fa" dir="rtl">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>ورود با JWT</title>-->
<!--    <script src="https://cdn.tailwindcss.com"></script>-->
<!--</head>-->
<!--<body class="bg-gradient-to-tr from-indigo-100 to-purple-200 flex items-center justify-center min-h-screen">-->

<!--    <div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-md">-->
<!--        <h2 class="text-2xl font-bold text-center mb-6 text-purple-700">ورود به حساب کاربری</h2>-->

<!--        <div class="space-y-4">-->
<!--            <div>-->
<!--                <label class="block mb-1 font-medium">نام کاربری</label>-->
<!--                <input type="text" id="username" placeholder="مثلاً ali123"-->
<!--                       class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">-->
<!--            </div>-->

<!--            <div>-->
<!--                <label class="block mb-1 font-medium">رمز عبور</label>-->
<!--                <input type="password" id="password" placeholder="رمز عبور"-->
<!--                       class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">-->
<!--            </div>-->

<!--            <button onclick="login()"-->
<!--                    class="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition duration-200">-->
<!--                ورود-->
<!--            </button>-->

<!--            <div id="result" class="text-center text-sm mt-4"></div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <script>-->
<!--        function login() {-->
<!--            const username = document.getElementById('username').value.trim();-->
<!--            const password = document.getElementById('password').value;-->
<!--            const resultDiv = document.getElementById('result');-->

<!--            fetch('/api/accounts/token/', {-->
<!--                method: 'POST',-->
<!--                headers: {-->
<!--                    'Content-Type': 'application/json'-->
<!--                },-->
<!--                body: JSON.stringify({ username, password })-->
<!--            })-->
<!--            .then(response => {-->
<!--                if (!response.ok) {-->
<!--                    throw new Error('ورود ناموفق بود');-->
<!--                }-->
<!--                return response.json();-->
<!--            })-->
<!--            .then(data => {-->
<!--                localStorage.setItem('access_token', data.access);-->
<!--                localStorage.setItem('refresh_token', data.refresh);-->
<!--                resultDiv.innerHTML = `<p class="text-green-600">ورود موفق! در حال انتقال...</p>`;-->
<!--                setTimeout(() => {-->
<!--                    window.location.href = '/dashboard.html';-->
<!--                }, 1000);-->
<!--            })-->
<!--            .catch(error => {-->
<!--                resultDiv.innerHTML = `<p class="text-red-600">نام کاربری یا رمز عبور اشتباه است.</p>`;-->
<!--                console.error('Login error:', error);-->
<!--            });-->
<!--        }-->
<!--    </script>-->

<!--</body>-->
<!--</html>-->


<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<title>ورود</title>
</head>
<body>
<h2>ورود</h2>
<form id="login-form">
    <label>نام کاربری: <input type="text" id="username" required></label><br><br>
    <label>رمز عبور: <input type="password" id="password" required></label><br><br>
    <button type="submit">ورود</button>
</form>
<p id="message" style="color:red;"></p>

<script>
document.getElementById('login-form').addEventListener('submit', async e => {
    e.preventDefault();
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();

    try {
        const res = await fetch('http://localhost:8000/api/token/', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({username, password})
        });

        if (!res.ok) throw new Error('نام کاربری یا رمز عبور اشتباه است');

        const data = await res.json();
        localStorage.setItem('access_token', data.access);
        localStorage.setItem('refresh_token', data.refresh);
        window.location.href = 'users.html';

    } catch(err) {
        document.getElementById('message').textContent = err.message;
    }
});
</script>
</body>
</html>

